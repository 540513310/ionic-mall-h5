angular.module("xgStore",["ionic","xgStore.controllers","xgStore.directives","xgStore.services"]).run(["$rootScope","$location","$state","$ionicHistory","$ionicNavBarDelegate","xgUser","$ionicPopup","$ionicLoading",function(t,e,r,o,l,i,n,s){t.entry=e.search().entry,t.returnMobile=function(){Ponto.invoke("H5ToMobileRequest","returnMobile",{entry:t.entry,msg:{}},null,null)},t.paymentSuccess=function(e){r.go("orderList",{}).then(function(){o.clearHistory(),l.showBackButton(!1),t.showBtns.returnMobile=!0;n.alert({title:"支付成功",subTitle:"亲, 订单已成功支付, 请耐心等待吧!",cssClass:"payment-success-popup",okText:"确定",okType:"button button-outline button-positive"})})},t.paymentFailure=function(e){r.go("orderList",{}).then(function(){o.clearHistory(),l.showBackButton(!1),t.showBtns.returnMobile=!0;var r=n.confirm({title:"支付失败",cssClass:"payment-failure-popup",subTitle:"亲, 该订单支付失败, 请重新支付!",cancelText:"取消",cancelType:"button button-outline button-dark",okText:"去支付",okType:"button button-outline button-positive"});r.then(function(t){if(1==t){var r={order_str:e.order_str,pay_type:e.pay_type};Ponto.invoke("H5ToMobileRequest","payment",r,null,null)}})})},t.showBtns={cart:!1,editAble:!1,addressAdd:!1,addressSave:!1,quitAble:!1,returnMobile:!1},t.editAllState=!1,t.showAlert=function(t,e){s.show({template:t,duration:e,noBackdrop:!0})},t.gotoShopCart=function(){i.getSessionId().then(function(t){r.go("shoppingCart")})}}]).config(["$ionicConfigProvider",function(t){var e={views:{maxCache:0,forwardCache:!1,transition:"ios"},navBar:{alignTitle:"center",positionPrimaryButtons:"ios",positionSecondaryButtons:"ios",transition:"ios"},backButton:{icon:"ion-ios-arrow-left",text:" ",previousTitleText:!1},form:{checkbox:"ios"},tabs:{style:"striped",position:"top"},templates:{}},r={views:{maxCache:0,forwardCache:!1,transition:"none"},navBar:{alignTitle:"center",positionPrimaryButtons:"ios",positionSecondaryButtons:"ios",transition:"none"},backButton:{icon:"ion-ios-arrow-left",text:" ",previousTitleText:!1},form:{checkbox:"ios"},tabs:{style:"striped",position:"top"},templates:{}};t.setPlatformConfig("android",r),t.setPlatformConfig("ios",e)}]).config(["$stateProvider","$urlRouterProvider",function(t,e){t.state("product",{url:"/product/:id",templateUrl:"templates/product/detail.html",controller:"productCtrl"}).state("shoppingCart",{url:"/shopping/cart",templateUrl:"templates/shopping/cart.html",controller:"cartCtrl"}).state("addressEdit",{url:"/address/edit/:id",templateUrl:"templates/address/edit.html",controller:"addressEditCtrl"}).state("addressList",{url:"/address/list",templateUrl:"templates/address/list.html",controller:"addressListCtrl"}).state("orderCheck",{url:"/order/check/:goodsIdList/:productIdList/:quantityList/:defaultAddressId",templateUrl:"templates/order/check.html",controller:"orderCheckCtrl"}).state("orderList",{url:"/order/list",params:{popup_type:null,order_str:null,pay_type:null},templateUrl:"templates/order/list.html",controller:"orderListCtrl"}).state("orderDetail",{url:"/order/detail/:id",templateUrl:"templates/order/detail.html",controller:"orderDetailCtrl"}).state("deliveryTrace",{url:"/delivery/trace/:id",templateUrl:"templates/delivery/trace.html",controller:"deliveryTraceCtrl"}).state("refundApply",{url:"/refund/apply/:order_id/:order_goods_id",templateUrl:"templates/refund/apply.html",controller:"refundApplyCtrl"}).state("refundDetail",{url:"/refund/detail/:order_id/:goods_id/:product_id",templateUrl:"templates/refund/detail.html",controller:"refundDetailCtrl"}),e.otherwise("/product/5")}]);
angular.module("xgStore.controllers",[]).controller("AppCtrl",["$scope","$rootScope","$ionicLoading","xgUser","$state",function(t,e,o,n,r){e.showBtns={cart:!1,editAble:!1,addressAdd:!1,addressSave:!1,quitAble:!1,returnMobile:!1},e.editAllState=!1,t.showAlert=function(t,e){o.show({template:t,duration:e,noBackdrop:!0})}}]).controller("productCtrl",["$scope","$rootScope","$http","$stateParams","$timeout","$ionicModal","$ionicLoading","sku",function(t,e,o,n,r,a,i,c){t.productInfo={},t.multiple=!1,t.moreHide=!0,t.specArray=[],t.$on("$ionicView.beforeEnter",function(){e.showBtns.cart=!0,e.showBtns.quitAble=!0,"goods"==e.entry&&(e.showBtns.returnMobile=!0)}),t.$on("$ionicView.beforeLeave",function(){e.showBtns.cart=!1,e.showBtns.quitAble=!1,"goods"==e.entry&&(e.showBtns.returnMobile=!1)}),t.$on("$stateChangeStart",function(){t.modal.hide()}),o.get("/api/goods/detail",{params:{goods_id:n.id,platform:"wap"}}).then(function(e){if("success"==e.data.status){if(t.productInfo=e.data.result,"object"==typeof e.data.result.price_range&&!(e.data.result.price_range instanceof Array))for(var o in e.data.result.price_range){t.multiple=!0;break}1==t.multiple?t.specArray=JSON.parse(e.data.result.spec_array):""}}),t.loadMoreData=function(){r(function(){t.moreHide=!1},1500)},a.fromTemplateUrl("templates/product/sku.html",{scope:t}).then(function(e){t.modal=e}),t.addCart=function(){e.buyNow=1,t.showSku()},t.checkNow=function(){e.buyNow=2,t.showSku()},t.showSku=function(){t.modal.show()},t.closeSku=function(){t.modal.hide()},t.showShare=function(){Ponto.invoke("H5ToMobileRequest","popupShareView",{},null,null)}}]).controller("skuCtrl",["$scope","$http","$stateParams","$ionicPopover","$location","xgApi","xgAddress","xgUser",function(t,e,o,n,r,a,i,c){function s(t,e){var o=!1;return angular.forEach(t,function(t){t==e&&(o=!0)}),o}t.xgAddress=i,t.item={quantity:1,id:0,goods_id:o.id,product_id:0},t.step=[],t.addItem=function(e){t.item.quantity=parseInt(t.item.quantity)+e},t.getProductId=function(e){var o=0;return 3!=Object.keys(t.step).length?o:(angular.forEach(t.productInfo.product_list,function(e){var n=JSON.parse(e.spec_array),r=[];angular.forEach(n,function(t){r.push(t.value)});var a=!0;for(var i in t.step){var c=t.step[i];if(0==s(r,c)){a=!1;break}}a&&(o=e.id)}),o)},t.changeItem=function(e,o,n){t.step[e]=o,t.specArray[e].clicked=n;var r=t.getProductId({id:e,value:o});r?t.item.product_id=r:""},t.addToCart=function(e,o){return t.multiple&&Object.keys(t.step).length!=Object.keys(t.specArray).length?void t.showAlert("请选择产品属性",1e3):(e?t.item.id=e:"",o?t.item.goods_id=o:"",void c.getSessionId().then(function(){return a.requestApi("api/cart/edit",t.item)}).then(function(e){t.closeSku(),t.showAlert("添加成功",1e3)}))},t.goCheckNow=function(){var e=0;return t.multiple&&Object.keys(t.step).length!=Object.keys(t.specArray).length?void t.showAlert("请选择产品属性",1e3):void c.getSessionId().then(function(){return a.requestApi("/api/user/detail",{})}).then(function(t){i.init(t.address_list)}).then(function(){t.closeSku(),e=i.getDefault().address_id||0,r.path("/order/check/"+t.item.goods_id+"/"+t.item.product_id+"/"+t.item.quantity+"/"+e)})}}]).controller("cartCtrl",["$scope","$http","$rootScope","$ionicModal","xgCart","xgApi","xgAddress","xgUser",function(t,e,o,n,r,a,i,c){t.xgCart=r,t.xgAddress=i,t.checkout={selected:0,total:0,allSelected:!1},t.$on("$ionicView.beforeEnter",function(){"cart"==o.entry&&(o.showBtns.returnMobile=!0)}),t.$on("$ionicView.beforeLeave",function(){"cart"==o.entry&&(o.showBtns.returnMobile=!1)}),t.$on("$stateChangeStart",function(){t.modal&&t.modal.hide()}),c.getSessionId().then(function(){return a.requestApi("/api/cart/rows",{})}).then(function(e){t.cartItems=e,r.init(e)}).then(function(){t.$watch("cartItems",function(e){var n=r.getCheckoutTotal(),a=r.getStoreId().length;angular.forEach(n,function(e,o){"object"==typeof e&&e.total==e.selected?(a--,angular.forEach(t.cartItems[o],function(t,e){t.seller.selected=!0})):angular.forEach(t.cartItems[o],function(t,e){t.seller.selected=!1})}),o.editAllState=r.getStoreAllState(),t.checkout=r.getCheckoutTotal(),t.checkout.allSelected=0==a?!0:!1},!0)}).then(function(){a.requestApi("/api/user/detail",{}).then(function(t){i.init(t.address_list)})}),t.toggleEdit=function(e){angular.forEach(t.cartItems[e],function(t){t.editNow=t.editNow?!1:!0})},o.toggleEditAll=function(){angular.forEach(t.cartItems,function(t){angular.forEach(t,function(t,e){t.editNow=o.editAllState?!1:!0})})},n.fromTemplateUrl("templates/product/sku.html",{scope:t}).then(function(e){t.modal=e}),t.changeSku=function(e,n){angular.forEach(t.cartItems[e],function(r,a){n==a&&(o.buyNow=3,t.editCartId=t.cartItems[e][a].cart.id,t.productInfo=t.cartItems[e][a].goods,t.specArray=JSON.parse(t.productInfo.spec_array),t.editGoodsId=t.productInfo.id)}),t.modal.show()},t.closeSku=function(){t.modal.hide()},t.addItem=function(e,o,n){angular.forEach(t.cartItems[e],function(t,e){e==o&&(t.cart.quantity=parseInt(t.cart.quantity)+n)})},t.delCartItem=function(e,o){angular.forEach(t.cartItems[e],function(n,r){if(r==o){var i={cart_id:n.cart.id};a.requestApi("/api/cart/delete",i).then(function(o){t.cartItems[e].splice(r,1)})}})},t.$on("$ionicView.beforeEnter",function(){o.showBtns.editAble=!0}),t.$on("$ionicView.beforeLeave",function(){o.showBtns.editAble=!1})}]);
angular.module("xgStore.services",[]).service("sku",function(){var t=[],e=function(e){t.push(e)},n=function(){return t};return{setInfo:e,getInfo:n}}).service("xgCart",["xgApi","$state","$location","xgAddress",function(t,e,n,a){this.init=function(t){angular.forEach(t,function(t,e){angular.forEach(t,function(t,e){t.selected=!1,t.editNow=!1,t.seller.selected=!1})}),this.cartItems=t},this.getStoreId=function(){var t=[];return angular.forEach(this.cartItems,function(e,n){t.push(n)}),t},this.getItems=function(t){var e=this.cartItems[t],n=0;return angular.forEach(e,function(t,e){n+=parseInt(t.cart.quantity)}),n},this.getStoreTotal=function(t){var e=this.cartItems[t],n=0;return angular.forEach(e,function(t,e){n+=t.goods.sell_price*t.cart.quantity}),n.toFixed(2)},this.getCartTotal=function(){var t=0,e=this;return angular.forEach(e.cartItems,function(n,a){t+=parseFloat(e.getStoreTotal(a),2)}),t},this.getCheckoutTotal=function(){var t={total:0,selected:0};return angular.forEach(this.cartItems,function(e,n){t[n]={total:0,selected:0},angular.forEach(e,function(e,a){t[n].total+=1,1==e.selected&&(t[n].selected+=1,t.selected+=1,t.total+=e.cart.quantity*e.goods.sell_price)})}),t},this.getStoreAllState=function(){var t=Object.keys(this.cartItems).length,e=0;return angular.forEach(this.cartItems,function(t,n){var a=0,r=t.length;angular.forEach(t,function(t,n){t.editNow&&a++,a==r&&e++})}),t==e&&t>0?!0:!1},this.selectAll=function(t){var e=this.getStoreId(),n=this;angular.forEach(e,function(e,a){n.selectStore(e,t)})},this.selectStore=function(t,e){var n=this.cartItems[t];e=null==e?n[0].seller.selected:!e,angular.forEach(n,function(t,n){e?(t.selected=!1,t.seller.selected=!1):(t.selected=!0,t.seller.selected=!0)})},this.checkoutNow=function(){var t={},e=[],r=[],s=[],i=a.getDefault().address_id||0;angular.forEach(this.cartItems,function(t,n){angular.forEach(t,function(t){1==t.selected&&(e.push(t.cart.goods_id),r.push(t.cart.product_id),s.push(t.cart.quantity))})}),t.goods_id_list=e.join(","),t.product_id_list=r.join(","),t.quantity_list=s.join(","),n.path("/order/check/"+t.goods_id_list+"/"+t.product_id_list+"/"+t.quantity_list+"/"+i)}}]).service("xgAddress",["xgApi",function(t){this.init=function(t){angular.forEach(t,function(t,e){t.choosed=!1}),this.addressList=t},this["default"]=function(t){angular.forEach(this.addressList,function(e,n){e.id==t&&(e["default"]=1),e["default"]=0})},this.getDefault=function(t){var e=null;return angular.forEach(this.addressList,function(n,a){null==t&&1==n["default"]&&(e=n),n.address_id==t&&(e=n)}),e},this.choose=function(t){angular.forEach(this.addressList,function(e,n){e.id==t&&(e.choosed=!0),e.choosed=0})}}]);
angular.module("xgStore.controllers").controller("addressEditCtrl",["$scope","$stateParams","$ionicLoading","$rootScope","$location","xgApi","xgUser",function(e,t,i,a,r,s,n){e.id=t.id,e.address={},e.province_list=[],e.city_list=[],e.area_list=[],e.$on("$ionicView.beforeEnter",function(){a.showBtns.addressSave=!0}),e.$on("$ionicView.beforeLeave",function(){a.showBtns.addressSave=!1}),e.getArea=function(t,i,a){s.requestApi("/api/area/find",{parent_id:t}).then(function(t){"province"==i&&(e.province_list=t,a&&(e.city_list=[],e.area_list=[])),"city"==i&&(e.city_list=t,a&&(e.area_list=[])),"area"==i&&(e.area_list=t)})},s.requestApi("/api/user/detail",{}).then(function(t){e.userInfo=t,e.getArea(0,"province",!1);var i=e.userInfo.address_list;angular.forEach(i,function(t){t.address_id==e.id&&(e.address=t,e.getArea(e.address.province,"city",!1),e.getArea(e.address.city,"area",!1))})}),a.addressSave=function(){n.getSessionId().then(function(){var t=e.address;return t["default"]=1==t["default"]?1:0,s.requestApi("/api/address/edit",t)}).then(function(e){i.show({template:"保存成功",noBackdrop:!0,duration:1e3}),r.path("/address/list")},function(e){i.show({template:e,noBackdrop:!0,duration:1e3})})}}]);
angular.module("xgStore.controllers").controller("addressListCtrl",["$scope","$rootScope","$state","$stateParams","$ionicLoading","xgUser","xgApi","$location","$ionicHistory",function(e,n,t,o,s,r,i,d,a){function u(){i.requestApi("/api/user/detail",{}).then(function(n){e.userInfo=n})["finally"](function(){e.$broadcast("scroll.refreshComplete")})}e.userInfo={},e.$on("$ionicView.beforeEnter",function(){n.showBtns.addressAdd=!0,"address"==n.entry&&(n.showBtns.returnMobile=!0),e.doRefresh()}),e.$on("$ionicView.beforeLeave",function(){n.showBtns.addressAdd=!1,"address"==n.entry&&(n.showBtns.returnMobile=!1)}),e.doRefresh=function(){r.getSessionId().then(function(){u()})},e.setDefault=function(n){r.getSessionId().then(function(){var t=e.userInfo.address_list,o={};return angular.forEach(t,function(e){e.address_id==n&&(o=e)}),o["default"]=1,i.requestApi("/api/address/edit",o)}).then(function(n){e.userInfo=n,s.show({template:"设置成功",noBackdrop:!0,duration:1e3})})},e.deleteAddress=function(n){r.getSessionId().then(function(){return i.requestApi("/api/address/delete",{address_id:n})}).then(function(n){e.userInfo=n,s.show({template:"删除成功",noBackdrop:!0,duration:1e3})})},e.chooseAddress=function(e){if(null!==a.backView()&&"orderCheck"==a.backView().stateName){var n=a.backView().stateParams;n.defaultAddressId=e,t.go("orderCheck",n)}}}]);
angular.module("xgStore.controllers").controller("deliveryTraceCtrl",["$scope","$stateParams","$ionicLoading","$rootScope","$location","xgApi","xgUser",function(e,r,o,t,i,n,d){e.order_id=r.id,d.getSessionId().then(function(){return n.requestApi("/api/delivery/trace",{order_id:e.order_id})}).then(function(r){e.data=r})}]);
angular.module("xgStore.controllers").controller("orderCheckCtrl",["$scope","$location","$state","$stateParams","xgApi","xgCart","xgAddress",function(t,r,e,o,s,d,a){r.search("entry",null),t.xgCart=d,t.address=a,t.postscript={};var i={goods_id_list:o.goodsIdList,product_id_list:o.productIdList,quantity_list:o.quantityList};console.log(i),s.requestApi("/api/order/check",i).then(function(r){t.orderCheck=r,t.CartStructure=r.cart_structure,console.log(r),d.init(t.CartStructure),a.init(t.orderCheck.address_list)}).then(function(){t.defaultAddress=a.getDefault(o.defaultAddressId)}),t.pay={method:100001},t.getAddress=function(){e.go("addressList",{},{relative:"^"})},t.getPayAmount=function(){var r=0;return angular.forEach(t.CartStructure,function(t,e){var o=0;angular.forEach(t,function(t,r){o+=t.goods.sell_price*t.cart.quantity}),r+=o}),r.toFixed(2)},t.payment=function(){var r=i;return r.address_id=o.defaultAddressId,r.pay_type=t.pay.method,r.postscript=t.postscript,0==r.address_id?void t.showAlert("请填写收货地址",1e3):void s.requestApi("/api/order/submit",r).then(function(t){Ponto.invoke("H5ToMobileRequest","payment",t,null,null)})}}]);
angular.module("xgStore.controllers").controller("orderDetailCtrl",["$scope","$http","$stateParams","$rootScope","$ionicLoading","$location","xgUser","xgApi","$ionicPopup",function(r,o,e,t,n,i,d,a,l){r.order_id=e.id,r.order={},r.order.lastDelivery="",r.$on("$ionicView.beforeEnter",function(){r.doRefresh()}),r.doRefresh=function(){d.getSessionId().then(function(){return a.requestApi("/api/order/detail",{order_id:r.order_id})}).then(function(o){return o.total_goods_price=0,angular.forEach(o.order_goods_list,function(r){r.goods_array=angular.fromJson(r.goods_array),o.total_goods_price+=r.real_price*r.goods_nums}),r.order=o,a.requestApi("/api/delivery/trace",{order_id:r.order_id})}).then(function(o){0!=o.length&&(r.order.lastDelivery=o[0].traces[o[0].traces.length-1])})["finally"](function(){r.$broadcast("scroll.refreshComplete")})},r.returnMobile=function(){t.returnMobile()}}]);
angular.module("xgStore.controllers").controller("orderListCtrl",["$scope","$http","$rootScope","$ionicLoading","$ionicNavBarDelegate","$state","$location","xgUser","xgApi","$ionicPopup","$stateParams",function(o,t,e,n,r,i,a,s,c,d,u){function l(t){var e={order_tab:o.orderTabList[t],page:o.pageList[t]};c.requestApi("/api/order/rows",e).then(function(n){1==o.pageList[t]&&(o.ordersList[t]=[]),angular.forEach(n.order_list,function(o,t){o.total_goods_num=0,o.total_goods_price=0,angular.forEach(o.order_goods_list,function(t,e){t.goods_array=angular.fromJson(t.goods_array),o.total_goods_num+=t.goods_nums,o.total_goods_price+=t.real_price*t.goods_nums})}),o.ordersList[t]=o.ordersList[t].concat(n.order_list),o.waitGoodsCount=n.wait_goods_count,o.waitPayCount=n.wait_pay_count,o.pageList[t]=o.pageList[t]+1,console.log(e),console.log(o.ordersList[t])},function(o){})["finally"](function(){o.$broadcast("scroll.refreshComplete"),o.$broadcast("scroll.infiniteScrollComplete")})}o.currentIndex=0,o.waitGoodsCount=0,o.waitPayCount=0,o.orderTabList=[0,1,2,3],o.pageList=[1,1,1,1],o.ordersList=[[],[],[],[]],o.$on("$ionicView.beforeEnter",function(){("order"==e.entry||"goods"==e.entry||"cart"==e.entry)&&(e.showBtns.returnMobile=!0)}),o.$on("$ionicView.enter",function(){}),o.$on("$ionicView.beforeLeave",function(){e.showBtns.returnMobile=!1,r.showBackButton(!0)}),o.doRefresh=function(t){s.getSessionId().then(function(){o.pageList[t]=1,l(t)})},o.loadMore=function(o){s.getSessionId().then(function(){l(o)})},o.onTabSelected=function(t){o.currentIndex=t,1==o.pageList[t]&&s.getSessionId().then(function(){l(t)})},o.buy=function(o){c.requestApi("/api/order/clickPay",{order_id:o,pay_type:100001}).then(function(o){Ponto.invoke("H5ToMobileRequest","payment",o,null,null)},function(o){n.show({template:o,noBackdrop:!0,duration:1e3})})},o.cancel=function(t){c.requestApi("/api/order/cancel",{order_id:t}).then(function(t){o.pageList=[1,1,1,1],o.ordersList=[[],[],[],[]],l(o.currentIndex),n.show({template:t.msg,noBackdrop:!0,duration:1e3})},function(o){n.show({template:o,noBackdrop:!0,duration:1e3})})},o.confirm=function(t,e){var r=d.confirm({title:"确认收货",cssClass:"confirm-order-popup",subTitle:e+" 元",cancelText:"取消",cancelType:"button button-outline button-dark",okText:"确定",okType:"button button-outline button-positive"});r.then(function(e){1==e&&c.requestApi("/api/order/confirm",{order_id:t}).then(function(t){o.pageList=[1,1,1,1],o.ordersList=[[],[],[],[]],l(o.currentIndex),n.show({template:t.msg,noBackdrop:!0,duration:1e3})},function(o){n.show({template:o,noBackdrop:!0,duration:1e3})})})},o.delivery=function(o){i.go("delivery.trace",{order_id:o})},o.rebuy=function(o){s.getSessionId().then(function(){return c.requestApi("/api/order/rebuy",{order_id:o})}).then(function(o){var t=o.goods_id_list+"/"+o.product_id_list+"/"+o.quantity_list+"/"+o.default_address_id;console.log(t),a.path("/app/order/check/"+t)})},o.remove=function(t){c.requestApi("/api/order/delete",{order_id:t}).then(function(t){o.pageList=[1,1,1,1],o.ordersList=[[],[],[],[]],l(o.currentIndex),n.show({template:t.msg,noBackdrop:!0,duration:1e3})},function(o){n.show({template:o,noBackdrop:!0,duration:1e3})})}}]);
angular.module("xgStore.controllers").controller("refundApplyCtrl",["$scope","$stateParams","$ionicLoading","$rootScope","xgApi","xgUser","$ionicPopup","$ionicHistory",function(t,o,n,e,r,i,u,d){t.order_id=o.order_id,t.order_goods_id=o.order_goods_id,t.form={},t.form.content="",t.refundAll=function(){a(0)},t.refundPart=function(){var t=u.prompt({title:"请输入退款金额并点击确定",subTitle:"(输入金额不得超过实付金额哦)",cssClass:"refund-input-popup",inputType:"text",cancelText:"取消",cancelType:"button button-outline button-dark",okText:"确定",okType:"button button-outline button-positive"});t.then(function(t){if(void 0!=t){var o=parseFloat(t);return isNaN(o)||0>=o?void alert("请输入有效金额"):void a(o)}})};var a=function(o){i.getSessionId().then(function(){return r.requestApi("/api/refund/apply",{order_id:t.order_id,order_goods_id:t.order_goods_id,amount:o,content:t.form.content})}).then(function(t){p(t.amount)},function(t){n.show({template:t,noBackdrop:!0,duration:1e3})})},p=function(t){var o=u.alert({title:"到账金额 "+t+" 元",subTitle:"亲, 您的退款已申请, 等待卖家处理!",cssClass:"refund-result-popup",inputType:"text",okText:"返回订单详情",okType:"button button-outline button-positive"});o.then(function(t){var o=d.backView();-1==o.url.indexOf("/app/refund/detail")?d.goBack():d.goBack(-2)})}}]);
angular.module("xgStore.controllers").controller("refundDetailCtrl",["$scope","$stateParams","$ionicLoading","$rootScope","xgApi","xgUser","$ionicPopup","$location",function(o,d,r,i,e,t,n,_){o.order_id=d.order_id,o.goods_id=d.goods_id,o.product_id=d.product_id,o.order={},o.order_goods={},o.data={},t.getSessionId().then(function(){return e.requestApi("/api/order/detail",{order_id:o.order_id})}).then(function(d){return o.order=d,angular.forEach(d.order_goods_list,function(d){return d.goods_id==o.goods_id&&d.product_id==o.product_id?void(o.order_goods=d):void 0}),e.requestApi("/api/refund/detail",{order_id:o.order_id,goods_id:o.goods_id,product_id:o.product_id})}).then(function(d){o.data=d;var r=o.order_goods.real_price*o.order_goods.goods_nums;o.data.origin_price=r.toFixed(2)})}]);
angular.module("xgStore.directives",[]).directive("tabs",function(){return{restrict:"E",transclude:!0,scope:{},controller:["$scope",function(e){var t=e.panes=[];e.select=function(e){angular.forEach(t,function(e){e.selected=!1}),e.selected=!0},this.addPane=function(a){0==t.length&&e.select(a),t.push(a)}}],template:'<div class="tab-able"><ul class="nav nav-tabs"><li ng-repeat="pane in panes" ng-class="{active:pane.selected}"><a href="" ng-click="select(pane)">{{pane.title}}</a></li></ul><div class="tab-content" ng-transclude></div></div>',replace:!0}}).directive("pane",function(){return{require:"^tabs",restrict:"E",transclude:!0,scope:{title:"@"},link:function(e,t,a,n){n.addPane(e)},template:'<div class="tab-pane" ng-class="{active: selected}" ng-transclude></div>',replace:!0}});
angular.module("xgStore.services").factory("xgApi",["$q","$http","$rootScope",function(e,s,t){var r=function(r,a){var o=e.defer();return a.platform="wap",void 0!=t.session_id&&(a.session_id=t.session_id),s.get(r,{params:a}).then(function(e){"success"==e.data.status?o.resolve(e.data.result):o.reject(e.data.message)}),o.promise};return{requestApi:r}}]);
angular.module("xgStore.services").factory("xgUser",["$rootScope","$ionicLoading","$q",function(e,r,o){var n=function(){var r=o.defer();return r.resolve("6b5c5275872a188de59944832b839beb6db05510"),e.session_id="6b5c5275872a188de59944832b839beb6db05510",r.promise};return{getSessionId:n}}]);